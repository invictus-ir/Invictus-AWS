#aws_attached_malicious_lambda_layer: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'lambda.amazonaws.com' AND eventName LIKE 'UpdateFunctionConfiguration%' ESCAPE '\')
#aws_cloudtrail_disable_logging: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'cloudtrail.amazonaws.com' AND eventName IN ('StopLogging', 'UpdateTrail', 'DeleteTrail'))
#aws_config_disable_recording: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'config.amazonaws.com' AND eventName IN ('DeleteDeliveryChannel', 'StopConfigurationRecorder'))
#aws_delete_identity: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'ses.amazonaws.com' AND eventName = 'DeleteIdentity')
#aws_ec2_disable_encryption: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'ec2.amazonaws.com' AND eventName = 'DisableEbsEncryptionByDefault')
#aws_ec2_startup_script_change: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'ec2.amazonaws.com' AND eventName = 'ModifyInstanceAttribute' AND requestParameters LIKE '%userData%')
#aws_ec2_vm_export_failure: SELECT * FROM DATABASE.TABLE WHERE ((eventName = 'CreateInstanceExportTask' AND eventSource = 'ec2.amazonaws.com') AND NOT ((errorMessage LIKE '%%%' ESCAPE '\') OR (errorCode LIKE '%%%' ESCAPE '\') OR (responseElements LIKE '%Failure%' ESCAPE '\')))
##aws_ecs_task_definition_cred_endpoint_query: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'ecs.amazonaws.com' AND eventName IN ('DescribeTaskDefinition', 'RegisterTaskDefinition', 'RunTask') AND requestParameters.containerDefinitions.command LIKE '%$AWS\_CONTAINER\_CREDENTIALS\_RELATIVE\_URI%' ESCAPE '\')
#aws_efs_fileshare_modified_or_deleted: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'elasticfilesystem.amazonaws.com' AND eventName = 'DeleteFileSystem')
#aws_efs_fileshare_mount_modified_or_deleted: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'elasticfilesystem.amazonaws.com' AND eventName = 'DeleteMountTarget')
#aws_eks_cluster_created_or_deleted: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'eks.amazonaws.com' AND eventName IN ('CreateCluster', 'DeleteCluster'))
#aws_elasticache_security_group_created: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'elasticache.amazonaws.com' AND eventName = 'CreateCacheSecurityGroup')
#aws_elasticache_security_group_modified_or_deleted: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'elasticache.amazonaws.com' AND eventName IN ('DeleteCacheSecurityGroup', 'AuthorizeCacheSecurityGroupIngress', 'RevokeCacheSecurityGroupIngress', 'AuthorizeCacheSecurityGroupEgress', 'RevokeCacheSecurityGroupEgress'))
#aws_enum_buckets: SELECT * FROM DATABASE.TABLE WHERE ((eventSource = 's3.amazonaws.com' AND eventName = 'ListBuckets') AND NOT (useridentity.type = 'AssumedRole'))
#aws_guardduty_disruption: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'guardduty.amazonaws.com' AND eventName = 'CreateIPSet')
#aws_iam_backdoor_users_keys: SELECT * FROM DATABASE.TABLE WHERE ((eventSource = 'iam.amazonaws.com' AND eventName = 'CreateAccessKey') AND NOT (userIdentity.arn LIKE '%responseElements.accessKey.userName%')) 
#aws_passed_role_to_glue_development_endpoint: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'glue.amazonaws.com' AND eventName IN ('CreateDevEndpoint', 'DeleteDevEndpoint', 'UpdateDevEndpoint'))
##aws_rds_change_master_password: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'rds.amazonaws.com' AND responseElements.pendingModifiedValues.masterUserPassword LIKE '%%%' ESCAPE '\' AND eventName = 'ModifyDBInstance')
##aws_rds_public_db_restore: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'rds.amazonaws.com' AND responseElements.publiclyAccessible = 'true' AND eventName = 'RestoreDBInstanceFromDBSnapshot')
##aws_root_account_usage: SELECT * FROM DATABASE.TABLE WHERE (useridentity.type = 'Root' AND NOT (unmapped['eventType'] = 'AwsServiceEvent'))
#aws_route_53_domain_transferred_lock_disabled: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'route53.amazonaws.com' AND eventName = 'DisableDomainTransferLock')
#aws_route_53_domain_transferred_to_another_account: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'route53.amazonaws.com' AND eventName = 'TransferDomainToAnotherAwsAccount')
#aws_s3_data_management_tampering: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 's3.amazonaws.com' AND eventName IN ('PutBucketLogging', 'PutBucketWebsite', 'PutEncryptionConfiguration', 'PutLifecycleConfiguration', 'PutReplicationConfiguration', 'ReplicateObject', 'RestoreObject'))
#aws_securityhub_finding_evasion: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'securityhub.amazonaws.com' AND eventName IN ('BatchUpdateFindings', 'DeleteInsight', 'UpdateFindings', 'UpdateInsight'))
#aws_snapshot_backup_exfiltration: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'ec2.amazonaws.com' AND eventName = 'ModifySnapshotAttribute')
aws_sts_assumerole_misuse: SELECT * FROM DATABASE.TABLE WHERE (userIdentity.type = 'AssumedRole' AND userIdentity.sessionContext.sessionIssuer.type = 'Role')
#aws_sts_getsessiontoken_misuse: SELECT * FROM DATABASE.TABLE WHERE (eventSource = 'sts.amazonaws.com' AND eventName = 'GetSessionToken' AND userIdentity.type = 'IAMUser')
#aws_susp_saml_activity: SELECT * FROM DATABASE.TABLE WHERE ((eventSource = 'sts.amazonaws.com' AND eventName = 'AssumeRoleWithSAML') OR (eventSource = 'iam.amazonaws.com' AND eventName = 'UpdateSAMLProvider'))
#aws_update_login_profile: SELECT * FROM DATABASE.TABLE WHERE ((eventSource = 'iam.amazonaws.com' AND eventName = 'UpdateLoginProfile'))